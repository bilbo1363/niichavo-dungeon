"""
Система записок НИИЧАВО
Записки в стиле книг Стругацких для атмосферы
"""
from typing import Dict, List
import random


class NiichavoNote:
    """Записка в стиле НИИЧАВО"""
    
    def __init__(self, title: str, text: str, floor_range: tuple):
        """
        Инициализация записки
        
        Args:
            title: Заголовок записки
            text: Текст записки
            floor_range: Диапазон этажей (min, max)
        """
        self.title = title
        self.text = text
        self.floor_range = floor_range
    
    def is_available_on_floor(self, floor: int) -> bool:
        """Проверка доступности на этаже"""
        return self.floor_range[0] <= floor <= self.floor_range[1]


# Записки для этажей 1-5 (Старые лаборатории)
LABORATORY_NOTES = [
    NiichavoNote(
        "Лабораторный журнал",
        "Эксперимент №47 провалился. Крысы снова увеличились в размерах.\n"
        "Саша говорит, что это нормально. Я не уверен.\n"
        "- Научный сотрудник Привалов",
        (1, 5)
    ),
    NiichavoNote(
        "Записка на доске",
        "ВНИМАНИЕ! Не кормить подопытных после полуночи!\n"
        "Последствия непредсказуемы.\n"
        "P.S. Кто покормил? Теперь они размером с собаку!",
        (1, 5)
    ),
    NiichavoNote(
        "Отчёт о происшествии",
        "Сегодня в лаборатории №3 произошёл инцидент.\n"
        "Колба с реагентом №13 разбилась.\n"
        "Пол теперь светится в темноте.\n"
        "Это нормально?",
        (2, 5)
    ),
    NiichavoNote(
        "Инструкция",
        "Правила работы в лаборатории:\n"
        "1. Не смешивать красное с синим\n"
        "2. Не думать о розовых слонах рядом с реагентом №7\n"
        "3. Если что-то взорвалось - это эксперимент\n"
        "4. Если ничего не взорвалось - эксперимент провалился",
        (1, 3)
    ),
    NiichavoNote(
        "Записка коллеге",
        "Витя, верни мой магический калькулятор!\n"
        "Он считает в шестнадцатеричной системе и предсказывает будущее.\n"
        "Без него не могу закончить отчёт.\n"
        "- Кристобаль Хунта",
        (3, 5)
    ),
]

# Записки для этажей 6-10 (Архивы и хранилища)
ARCHIVE_NOTES = [
    NiichavoNote(
        "Каталожная карточка",
        "Книга без названия. Шкаф 666, полка 13.\n"
        "ВНИМАНИЕ: Не читать вслух!\n"
        "Не читать про себя!\n"
        "Вообще не читать!\n"
        "Статус: Утеряна (к счастью)",
        (6, 10)
    ),
    NiichavoNote(
        "Дневник библиотекаря",
        "Нашёл книгу без названия. Она шепчет по ночам.\n"
        "Завтра отнесу в запечатанное хранилище.\n"
        "Если доживу.\n"
        "UPD: Дожил. Книга в хранилище. Но теперь шепчет хранилище.",
        (6, 8)
    ),
    NiichavoNote(
        "Предупреждение",
        "Уважаемые коллеги!\n"
        "Не трогайте артефакты голыми руками.\n"
        "Особенно те, что светятся.\n"
        "Особенно те, что не светятся, но должны.\n"
        "Особенно ВСЕ артефакты.\n"
        "- Отдел техники безопасности",
        (7, 10)
    ),
    NiichavoNote(
        "Исследовательская записка",
        "Обнаружил интересный парадокс:\n"
        "Книга о том, как не читать книги.\n"
        "Чтобы узнать, как не читать, нужно прочитать.\n"
        "Но если прочитал - значит читаешь.\n"
        "Голова болит.",
        (8, 10)
    ),
    NiichavoNote(
        "Объявление",
        "ПОТЕРЯЛСЯ: Кот Василий, серый, умеет телепортироваться.\n"
        "Последний раз видели на 7 этаже.\n"
        "Или на 9-м. Или одновременно на обоих.\n"
        "Квантовая механика - штука сложная.",
        (6, 9)
    ),
]

# Записки для этажей 11-15 (Экспериментальные зоны)
EXPERIMENTAL_NOTES = [
    NiichavoNote(
        "Журнал экспериментов",
        "Эксперимент по открытию портала удался!\n"
        "Правда, ведёт не туда, куда планировали.\n"
        "Зато красиво!\n"
        "P.S. Кто-то прошёл через портал. Вернулся через 5 минут.\n"
        "Говорит, там интересно, но страшно.",
        (11, 15)
    ),
    NiichavoNote(
        "Предупреждение об опасности",
        "ОПАСНО! Магическая лава!\n"
        "Не трогать! Не пробовать! Не нюхать!\n"
        "Температура: ∞°C\n"
        "Состояние: Жидкое, твёрдое, газообразное (одновременно)\n"
        "Настроение: Агрессивное",
        (12, 15)
    ),
    NiichavoNote(
        "Отчёт о кристаллах",
        "Кристаллы растут быстрее, чем ожидалось.\n"
        "Вчера были размером с кулак.\n"
        "Сегодня - с человека.\n"
        "Завтра... лучше не думать о завтра.\n"
        "Рекомендую эвакуацию.",
        (11, 13)
    ),
    NiichavoNote(
        "Записка на установке",
        "НЕ НАЖИМАТЬ КРАСНУЮ КНОПКУ!\n"
        "Серьёзно, не надо.\n"
        "Я знаю, что вы хотите.\n"
        "Все хотят нажать красную кнопку.\n"
        "НО НЕ НАДО!\n"
        "(Кнопка нажата, установка не работает)",
        (13, 15)
    ),
    NiichavoNote(
        "Дневник исследователя",
        "День 15: Портал стабилизировался.\n"
        "День 16: Из портала что-то вышло.\n"
        "День 17: Мы подружились.\n"
        "День 18: Оно научилось говорить.\n"
        "День 19: Оно ушло обратно. Сказало, что у нас скучно.",
        (14, 15)
    ),
]

# Записки для этажей 16-20 (Зона катастрофы)
CATASTROPHE_NOTES = [
    NiichavoNote(
        "Последнее сообщение",
        "Если вы это читаете - уходите.\n"
        "Здесь больше нет ничего живого.\n"
        "Только эхо того, что было.\n"
        "И то, что не должно было быть.\n"
        "Бегите.",
        (16, 20)
    ),
    NiichavoNote(
        "Записка из будущего",
        "Время здесь течёт странно.\n"
        "Я написал эту записку вчера,\n"
        "но она появилась только сегодня.\n"
        "Или завтра?\n"
        "Я уже не помню, когда сейчас.",
        (16, 18)
    ),
    NiichavoNote(
        "Предупреждение",
        "РЕАЛЬНОСТЬ НЕСТАБИЛЬНА!\n"
        "Не верьте своим глазам.\n"
        "Не верьте своим ушам.\n"
        "Не верьте этой записке.\n"
        "Особенно последней строчке.",
        (17, 20)
    ),
    NiichavoNote(
        "Отчёт о катастрофе",
        "Эксперимент вышел из-под контроля.\n"
        "Пространство искажается.\n"
        "Время петляет.\n"
        "Законы физики ушли в отпуск.\n"
        "Рекомендую немедленную эвакуацию.\n"
        "P.S. Уже поздно.",
        (18, 20)
    ),
    NiichavoNote(
        "Последняя запись",
        "Я вижу то, чего не должно существовать.\n"
        "Я слышу музыку сфер.\n"
        "Я понимаю всё.\n"
        "И это ужасно.\n"
        "Не спускайтесь глубже.",
        (19, 20)
    ),
]

# Все записки
ALL_NOTES = LABORATORY_NOTES + ARCHIVE_NOTES + EXPERIMENTAL_NOTES + CATASTROPHE_NOTES


class NiichavoNoteManager:
    """Менеджер записок НИИЧАВО"""
    
    @staticmethod
    def get_random_note_for_floor(floor: int) -> NiichavoNote:
        """
        Получить случайную записку для этажа
        
        Args:
            floor: Номер этажа
            
        Returns:
            Случайная записка, подходящая для этого этажа
        """
        available_notes = [
            note for note in ALL_NOTES 
            if note.is_available_on_floor(floor)
        ]
        
        if not available_notes:
            # Fallback на общую записку
            return NiichavoNote(
                "Записка",
                "Здесь была записка, но её кто-то унёс.",
                (1, 20)
            )
        
        return random.choice(available_notes)
    
    @staticmethod
    def get_all_notes_for_floor(floor: int) -> List[NiichavoNote]:
        """
        Получить все доступные записки для этажа
        
        Args:
            floor: Номер этажа
            
        Returns:
            Список всех записок для этого этажа
        """
        return [
            note for note in ALL_NOTES 
            if note.is_available_on_floor(floor)
        ]


if __name__ == "__main__":
    # Тест системы записок
    print("🔮 Тест системы записок НИИЧАВО\n")
    
    for floor in [1, 5, 10, 15, 20]:
        note = NiichavoNoteManager.get_random_note_for_floor(floor)
        print(f"Этаж {floor}: {note.title}")
        print(f"{note.text}\n")
